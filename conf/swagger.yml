openapi: 3.0.3
info:
  title: Pillar 2 API
  description: An API for managing and retrieving data in accordance with Pillar 2 tax rules.
servers:
  - url: https://test-api.service.hmrc.gov.uk
    description: Sandbox
  - url: https://api.service.hmrc.gov.uk
    description: Production
paths:
  /uk-tax-return:
    post:
      summary: Submit UK Tax Return
      description: |
        Submits a UK Tax Return for a specified accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a SubmitUKTR or AmendUKTR request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account. If you are amending an existing return, please check the request dates fall within the amendment window (12 months after the due date, minus 1 day).</td>
        </tr>
        <tr>
        <td>044 - Tax Obligation already fulfilled</td>
        <td>A UKTR for the specified period has already been submitted. If you are trying to amend a UKTR, please check you are sending the <em>amendUKTR</em> API request.</td>
        </tr>
        <tr>
        <td>063 - Business partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        <tr>
        <td>093 - Invalid Return</td>
        <td>There is an error with the tax return you’ve submitted in the request. Entities registered as UK only should check that <em>obligationMTT</em> is set to false, and <em>totalLiabilityIIR</em>, <em>amountOwedIIR</em>, <em>totalLiabilityUTPR</em> and <em>amountOwedUTPR</em> should be set to 0. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in the test organisation. If you need to check or amend the accounting period pattern, you can do this on the Pillar 2 site under “Personal Details”.</td>
        </tr>
        <tr>
        <td>094 - Invalid DTT Election</td>
        <td>The DTT values in the request are invalid. Please complete the following checks, then submit the request again. If <em>electionDTTSingleMember</em> is true, the <em>numberSubGroupDTT</em> should be greater than 0. This number represents the number of liable entities that owe a DTT amount greater than 0. The total number of liable entities who owe DTT in the payload should be the same as the number in <em>numberSubGroupDTT</em>.</td>
        </tr>
        <tr>
        <td>095 - Invalid UTPR Election</td>
        <td>The UTPR values in the request are invalid. Please complete the following checks, then submit the request again. If <em>electionUTPRSingleMember</em> is true, the <em>numberSubGroupUTPR</em> should be greater than 0. This number represents the number of liable entities that owe a UTPR amount greater than 0. The total number of liable entities who owe UTPR in the payload should be the same as the number in <em>numberSubGroupUTPR</em>.</td>
        </tr>
        <tr>
        <td>096 - Invalid Total Liability</td>
        <td>The <em>totalLiability</em> value in the request does not match the combined values of <em>totalLiabilityDTT</em>, <em>totalLiabilityIIR</em> and <em>totalLiabilityUTPR</em>. Please check the sum of these fields matches the <em>totalLiability</em> value and submit the request again.</td>
        </tr>
        <tr>
        <td>097 - Invalid Total Liability IIR</td>
        <td>The <em>totalLiabilityIIR</em> value does not match the <em>amountIIR value</em> from the <em>liableEntities</em> array. IIR values should only be entered by entities registered as a Multinational Enterprise. Please check the individual totals of each entity and submit the request again.</td>
        </tr>
        <tr>
        <td>098 - Invalid Total Liability DTT</td>
        <td>The <em>totalLiabilityDTT</em> value does not match the <em>amountDTT</em> value from the <em>liableEntities</em> array. Please check the value of these fields matches and submit the request again.</td>
        </tr>
        <tr>
        <td>099 - Invalid Total Liability UTPR</td>
        <td>The <em>totalLiabilityUTPR</em> value does not match the <em>amountUTPR</em> value from the <em>liableEntities</em> array. UTPR values should only be entered by entities registered as a Multinational Enterprise. Please check the individual totals of each entity and submit the request again.</td>
        </tr>
        </tbody>
        </table>
      requestBody:
        content:
          application/json:
            examples:
              NilReturnMneAndUk:
                $ref: "#/components/examples/requests.UKTRNilReturnMneAndUk"
              NilReturnDomesticOnlyWithUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithUkGaap"
              NilReturnDomesticOnlyWithoutUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithoutUkGaap"
              LiabilityReturnMneAndUkOneEntity:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithOneEntity"
              LiabilityReturnMneAndUkTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithTwoEntities"
              LiabilityReturnDomesticOneEntityUkGaap:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap"
              LiabilityReturnDomesticTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyTwoEntities"
      responses:
        "201":
          description: UK Tax Return Submission Created
          content:
            application/json:
              examples:
                responses.UKTRSuccessResponseWithCRNExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithCrnExample"
                responses.UKTRSuccessResponseWithoutCrnExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithoutCrnExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid UTPR Election:
                  $ref: "#/components/examples/errors.Submission.InvalidUTPR"
                Invalid Total Liability IIR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityIIR"
                Invalid DTT Election:
                  $ref: "#/components/examples/errors.Submission.InvalidDTT"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Invalid Total Liability UTPR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityUTPR"
                Invalid Total Liability:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiability"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Total Liability DTT:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityDTT"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
      security:
        - userRestricted: [write:pillar2]
    put:
      summary: Amend UK Tax Return
      description: |
        Amends a UK tax return submitted for a specified accounting period.   

        ### Error Codes
        <p>AmendUKTR generates the same error codes as Submit UKTR, please use the Error Codes table in the SubmitUKTR section above.</p>
      requestBody:
        content:
          application/json:
            examples:
              NilReturnMneAndUk:
                $ref: "#/components/examples/requests.UKTRNilReturnMneAndUk"
              NilReturnDomesticOnlyWithUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithUkGaap"
              NilReturnDomesticOnlyWithoutUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithoutUkGaap"
              LiabilityReturnMneAndUkOneEntity:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithOneEntity"
              LiabilityReturnMneAndUkTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithTwoEntities"
              LiabilityReturnDomesticOneEntityUkGaap:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap"
              LiabilityReturnDomesticTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyTwoEntities"
      responses:
        "200":
          description: UK Tax Return Submission Updated
          content:
            application/json:
              examples:
                responses.UKTRSuccessResponseWithCRNExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithCrnExample"
                responses.UKTRSuccessResponseWithoutCrnExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithoutCrnExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid UTPR Election:
                  $ref: "#/components/examples/errors.Submission.InvalidUTPR"
                Invalid Total Liability IIR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityIIR"
                Invalid DTT Election:
                  $ref: "#/components/examples/errors.Submission.InvalidDTT"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Invalid Total Liability UTPR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityUTPR"
                Invalid Total Liability:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiability"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Total Liability DTT:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityDTT"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
      security:
        - userRestricted: [write:pillar2]
  /below-threshold-notification:
    post:
      summary: Submit Below-Threshold Notification
      description: |
        Submits a Below-Threshold Notification for a specified accounting period when the group no longer meets the threshold for the Pillar 2 top-up tax.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a SubmitBTN request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account.</td>
        </tr>
        <tr>
        <td>044 - Tax Obligation already fulfilled</td>
        <td>A BTN for the specified period has already been submitted.</td>
        </tr>
        <tr>
        <td>063 - Business partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        <tr>
        <td>100 - Accounting period under enquiry</td>
        <td>A BTN cannot be submitted for this particular accounting period as it is currently subject to an HMRC enquiry.</td>
        </tr>
        </tbody>
        </table>
      requestBody:
        content:
          application/json:
            examples:
              requests.BTNRequestExample:
                $ref: "#/components/examples/requests.BTNRequestExample"
      responses:
        "201":
          description: Below-Threshold Notification Submission Created
          content:
            application/json:
              examples:
                responses.BTNSuccessResponseExample:
                  $ref: "#/components/examples/responses.BTNSuccessResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Accounting Period Under Enquiry:
                  $ref: "#/components/examples/errors.Submission.AccountingPeriodUnderEnquiry"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
      security:
        - userRestricted: [write:pillar2]
  /obligations-and-submissions:
    get:
      summary: Retrieve Obligations and Submissions
      description: |
        Retrieves the Obligations and Submissions for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a Retrieve Obligations and Submissions request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account.</td>
        </tr>
        <tr>
        <td>014 - No data found</td>
        <td>No data found for this Pillar 2 ID.</td>
        </tr>
        <tr>
        </tbody>
        </table>
      responses:
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Data Found:
                  $ref: "#/components/examples/errors.Submission.NoDataFound"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
                Invalid Date Format:
                  $ref: "#/components/examples/errors.InvalidDateFormat"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "200":
          description: OK Obligations and Submissions retrieved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObligationsAndSubmissionsSuccessResponse"
      security:
        - userRestricted: [read:pillar2]
  /overseas-return-notification:
    post:
      summary: Submit Overseas Return Notification
      description: |
        Submits an Overseas Return Notification for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a Submit Overseas Return Notification request is not processed successfully.</p> 
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please make the following checks. Confirm if there is currently an open enquiry on your tax account. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in your test organisation. The <em>filedDateGIR</em> date should not be in the future. The <em>countryGIR</em> and <em>issuingCountryTIN</em> fields must conform to the ISO-3166 standard for country codes. In the organisation’s settings, the <em>accountStatus</em> should have the <em>inactive</em> flag set to “false".
        </td>
        </tr>
        <tr>
        <td>044 - Tax Obligation already fulfilled</td>
        <td>A BTN for the specified period has already been submitted.</td>
        </tr>
        <tr>
        <td>063 - Business Partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        <tr>
        <td>093 - Invalid Return</td>
        <td>There is an error with the return you’ve submitted in the request.</td>
        </tr>
        </tbody>
        </table>
      requestBody:
        content:
          application/json:
            examples:
              requests.ORNRequestExample:
                $ref: "#/components/examples/requests.ORNRequestExample"
      responses:
        "201":
          description: Overseas Return Notification Submission Created
          content:
            application/json:
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNSuccessResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
      security:
        - userRestricted: [write:pillar2]
    put:
      summary: Amend Overseas Return Notification
      description: |
        Amends an Overseas Return Notification for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when an Amend Overseas Return Notification request is not processed successfully.</p> 
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please make the following checks. Confirm if there is currently an open enquiry on your tax account. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in your test organisation. The <em>filedDateGIR</em> date should not be in the future. The <em>countryGIR</em> and <em>issuingCountryTIN</em> fields must conform to the ISO-3166 standard for country codes. In the organisation’s settings, the <em>accountStatus</em> should have the <em>inactive</em> flag set to “false".
        </td>
        </tr>
        <tr>
        <td>063 - Business Partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        <tr>
        <td>093 - Invalid Return</td>
        <td>There is an error with the return you’ve submitted in the request.</td>
        </tr>
        </tbody>
        </table>
      requestBody:
        content:
          application/json:
            examples:
              requests.ORNRequestExample:
                $ref: "#/components/examples/requests.ORNRequestExample"
      responses:
        "200":
          description: Overseas Return Notification Submission Amended
          content:
            application/json:
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNSuccessResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
      security:
        - userRestricted: [write:pillar2]
    get:
      summary: Retrieve Overseas Return Notification
      description: |
        Retrieves an Overseas Return Notification for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a Retrieve Overseas Return Notification request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account.</td>
        </tr>
        </tbody>
        </table>
      responses:
        "200":
          description: Overseas Return Notification Retrieved Successfully
          content:
            application/json:
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNRetrieveSuccessResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
                Invalid Date Format:
                  $ref: "#/components/examples/errors.InvalidDateFormat"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              examples:
                NotFound:
                  $ref: "#/components/examples/errors.Retrieval.NotFound"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
      security:
        - userRestricted: [read:pillar2]
  /setup/organisation:
    post:
      summary: Create Test Organisation
      description: |
        Creates a test organisation associated with your authorised organisation.
      requestBody:
        content:
          application/json:
            examples:
              CreateTestOrganisationRequestExample:
                $ref: "#/components/examples/requests.TestOrganisationRequestExample"
      responses:
        "201":
          description: Test Organisation Created
          content:
            application/json:
              examples:
                CreateTestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
      security:
        - userRestricted: [write:pillar2]
    get:
      summary: Get Test Organisation
      description: |
        Gets a test organisation associated with your authorised organisation.
      responses:
        "200":
          description: Test Organisation Found
          content:
            application/json:
              examples:
                TestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
      security:
        - userRestricted: [read:pillar2]
    put:
      summary: Update Test Organisation
      description: |
        Updates a test organisation associated with your authorised organisation.
      requestBody:
        content:
          application/json:
            examples:
              UpdateTestOrganisationRequestExample:
                $ref: "#/components/examples/requests.TestOrganisationRequestExample"
      responses:
        "200":
          description: Test Organisation Updated
          content:
            application/json:
              examples:
                UpdateTestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
      security:
        - userRestricted: [write:pillar2]
    delete:
      summary: Delete Test Organisation
      description: |
        Deletes a test organisation associated with your authorised organisation.
      responses:
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
      security:
        - userRestricted: [write:pillar2]
  /setup/globe-information-return:
    post:
      summary: Create A Test GloBE Information Return
      description: |
        Creates a GloBE Information Return for a test organisation.
      requestBody:
        content:
          application/json:
            examples:
              CreateTestGlobeInformationReturnRequestExample:
                $ref: "#/components/examples/requests.CreateTestGlobeInformationReturnRequestExample"
      responses:
        "201":
          description: Globe Information Return Created
          content:
            application/json:
              examples:
                CreateTestGlobeInformationReturnResponseExample:
                  $ref: "#/components/examples/responses.CreateTestGlobeInformationReturnResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Unprocessable Entity
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      security:
        - userRestricted: [write:pillar2]
components:
  schemas:
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSubmission:
      properties:
        accountingPeriodFrom:
          description: The calendar date upon which a business' accounting period begins.
        accountingPeriodTo:
          description: The calendar date upon which a business' accounting period ends.
        filedDateGIR:
          description: The date upon which the GloBE Information Return (GIR) was filed or submitted.
        countryGIR:
          type: string
          minLength: 1
          maxLength: 2
          description: The country in which the GloBE Information Return (GIR) was submitted.
        reportingEntityName:
          type: string
          minLength: 1
          maxLength: 200
          description: The name of the company that submitted the Overseas Return Notification (ORN).
        TIN:
          type: string
          minLength: 1
          maxLength: 200
          description: The Tax Identification Number of the entity submitting the Overseas Return Notification.
        issuingCountryTIN:
          type: string
          minLength: 1
          maxLength: 2
          description: The country in which the Tax Identification Number was issued.
      required:
        - accountingPeriodFrom
        - accountingPeriodTo
        - filedDateGIR
        - countryGIR
        - reportingEntityName
        - TIN
        - issuingCountryTIN
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSuccessResponse:
      properties:
        processingDate:
          description: The date and time that an event took place.
        formBundleNumber:
          description: A unique identifier for the request, to be noted and retained in case amendments need to be filed against the return.
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNRetrieveSuccessResponse:
      properties:
        processingDate:
          description: The date and time that an event took place.
        accountingPeriodFrom:
          description: The calendar date upon which a business' accounting period begins.
        accountingPeriodTo:
          description: The calendar date upon which a business' accounting period ends.
        filedDateGIR:
          description: The date upon which the GloBE Information Return (GIR) was filed or submitted.
        countryGIR:
          description: The country in which the GloBE Information Return (GIR) was submitted.
        reportingEntityName:
          description: The name of the company that submitted the Overseas Return Notification (ORN).
        TIN:
          description: The Tax Identification Number of the entity that submitted the Overseas Return Notification.
        issuingCountryTIN:
          description: The country in which the Tax Identification Number was issued.
    uk.gov.hmrc.pillar2submissionapi.models.belowthresholdnotification.BTNSubmission:
      properties:
        accountingPeriodFrom:
          description: The calendar date upon which a business' accounting period begins.
        accountingPeriodTo:
          description: The calendar date upon which a business' accounting period ends.
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.responses.UKTRSubmitSuccessResponse:
      properties:
        processingDate:
          description: The date and time that an event took place.
        formBundleNumber:
          description: A unique identifier for the request, to be noted and retained in case amendments need to be filed against the return.
        chargeReference:
          description: Identifier for any liabilities specified in the return. Nil returns do not return a charge reference.
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionData:
      description: |
        A liability is a return for UKTR per accounting period which needs to be submitted (unless a BTN has been submitted). This is to be returned annually, and certain groups will need to submit this, whereas others will not.
        For the groups which do not need to submit a liability return, the value will be nil.
        For the groups which do need to submit an annual liability return, then the information found in the array will need to be populated.
      properties:
        accountingPeriodFrom:
          description: The calendar date upon which a business' accounting period begins.
        accountingPeriodTo:
          description: The calendar date upon which a business' accounting period ends.
        obligationMTT:
          description: Specifies whether a multinational group owes IIR or UTPR Pillar 2 tax. In the case where a group is 'domestic only', then the value must be `false`.
        electionUKGAAP:
          description: A means of calculating tax liability and profit. For domestic-only groups, the value must be `true`. For multinational groups, it must be `false`.
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionNilReturn:
      properties:
        accountingPeriodFrom:
          description: The calendar date upon which a business' accounting period begins.
        accountingPeriodTo:
          description: The calendar date upon which a business' accounting period ends.
        obligationMTT:
          description: Specifies whether a multinational group owes IIR or UTPR Pillar 2 tax. In the case where a group is 'domestic only', then the value must be `false`.
        electionUKGAAP:
          description: A means of calculating tax liability and profit. For domestic-only groups, the value must be `true`. For multinational groups, it must be `false`.
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityNilReturn:
      description: |
        A liability is a return for UKTR per accounting period which needs to be submitted (unless a BTN has been submitted). This is to be returned annually, and certain groups will need to submit this, whereas others will not.
        For the groups which do not need to submit a liability return, the value will be nil.
        For the groups which do need to submit an annual liability return, then the information found in the array will need to be populated.
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityData:
      description: |
        A liability is a return for UKTR per accounting period which needs to be submitted (unless a BTN has been submitted). This is to be returned annually, and certain groups will need to submit this, whereas others will not.
        For the groups which do not need to submit a liability return, the value will be nil.
        For the groups which do need to submit an annual liability return, then the information found in the array will need to be populated.
    uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisationWithId:
      properties:
        pillar2Id:
          description: A unique identifier for Pillar 2. Each company will have a different ID, allocated by HMRC.
    uk.gov.hmrc.pillar2submissionapi.models.organisation.AccountingPeriod:
      description: The period in which a group would be submitting their Pillar 2 returns to HMRC. This period of time varies amongst different businesses. It is effectively their "business year", and is expected to be the same as their accounting period with Pillar 2.
      properties:
        startDate:
          description: The start date of the accounting period.
        endDate:
          description: The end date of the accounting period.
        underEnquiry:
          description: Specifies whether an HMRC enquiry into the group is underway. The group will have been notified before the enquiry begins. If a group is under enquiry, then the value will be `true`. In this time period, amendments to a UKTR and submission of a BTN may not be processed depending on the outcome of the enquiry.
    uk.gov.hmrc.pillar2submissionapi.models.organisation.OrgDetails:
      description: Contains information about an organisation that is registered to Pillar 2.
      properties:
        domesticOnly:
          description: Specifies whether a group only operates in the UK, or whether it has any companies within it which operate abroad. For a company that is registered in the UK but has offices which are based abroad, the value will be `false`.
        organisationName:
          description: The full name of a company registered on Pillar 2.
        registrationDate:
          description: The date that a group successfully registers and subscribes to Pillar 2 with HMRC.
    Submission:
      properties:
        submissionType:
          type: string
          enum:
            - UKTR_CREATE
            - UKTR_AMEND
            - ORN_CREATE
            - ORN_AMEND
            - BTN
            - GIR
        receivedDate:
          type: string
          format: date-time
        country:
          type: string
          nullable: true
      required:
        - submissionType
        - receivedDate
    AccountingPeriodDetails:
      description: Contains the details of an accounting period. This includes when the period starts and ends, alongside any obligations and submissions.
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        dueDate:
          type: string
          format: date
        underEnquiry:
          type: boolean
        obligations:
          type: array
          items:
            $ref: "#/components/schemas/Obligation"
      required:
        - startDate
        - endDate
        - dueDate
        - underEnquiry
        - obligations
    Obligation:
      properties:
        obligationType:
          type: string
          enum:
            - UKTR
            - GIR
        status:
          type: string
          enum:
            - Open
            - Fulfilled
        canAmend:
          type: boolean
        submissions:
          type: array
          items:
            $ref: "#/components/schemas/Submission"
      required:
        - obligationType
        - status
        - canAmend
        - submissions
    ObligationsAndSubmissionsSuccessResponse:
      properties:
        processingDate:
          type: string
          format: date-time
        accountingPeriodDetails:
          type: array
          items:
            $ref: "#/components/schemas/AccountingPeriodDetails"
      required:
        - processingDate
        - accountingPeriodDetails
    uk.gov.hmrc.pillar2submissionapi.models.accountactivity.AccountActivitySuccessResponse:
      properties:
        processingDate:
          description: The date and time that an event took place.
          type: string
          format: date-time
        transactionDetails:
          description: Records of a change to a Pillar ID's circumstances from the chosen time period.
          type: array
          items:
            $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.accountactivity.AccountActivityTransaction"
      required:
        - processingDate
        - transactionDetails
    uk.gov.hmrc.pillar2submissionapi.models.accountactivity.AccountActivityTransaction:
      description: Represents a record of a change to a Pillar ID's circumstances.
      properties:
        transactionType:
            description: The form of transaction that took place. Examples include 'Credit' 'Debit' and 'Payment'.
            type: string
        transactionDesc:
          description: Description of a transaction that took place.
          type: string
        startDate:
          description: Start date of the relevant accounting period.
          type: string
          format: date
        endDate:
          description: End date of the relevant accounting period.
          type: string
          format: date
        accruedInterest:
          description: Interest accrued by delayed payment of this transaction, in GBP.
          type: number
          minimum: 0
          maximum: 9.999999999999E10
          multipleOf: 0.01
        chargeRefNo:
          description: Reference for the relevant charge kind.
          type: string
        transactionDate:
          description: Date of the transaction.
          type: string
          format: date
        dueDate:
          description: Date the transaction must be settled by.
          type: string
          format: date
        originalAmount:
          description: The original monetary value of the transaction, in GBP.
          type: number
          minimum: -9.999999999999E10
          maximum: 9.999999999999E10
          multipleOf: 0.01
        outstandingAmount:
          description: The unresolved monetary value of the transaction, in GBP.
          type: number
          minimum: -9.999999999999E10
          maximum: 9.999999999999E10
          multipleOf: 0.01
        clearedAmount:
          description: The resolved monetary value of the transaction, in GBP.
          type: number
          minimum: -9.9999999999E8
          maximum: 9.9999999999E8
          multipleOf: 0.01
        standOverAmount:
          description: The portion of the transaction's monetary value (in GBP) for which collection is postponed.
          type: number
          minimum: -9.9999999999E8
          maximum: 9.9999999999E8
          multipleOf: 0.01
        appealFlag:
          description: Indicates that the transaction is currently under appeal when present and true.
          type: boolean
        clearingDetails:
          description: Information on how other transactions are allocated against this one.
          type: array
          items:
            $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.accountactivity.AccountActivityClearance"
      required:
        - transactionType
        - transactionDesc
        - transactionDate
        - originalAmount
    uk.gov.hmrc.pillar2submissionapi.models.accountactivity.AccountActivityClearance:
      description: Information on how another transaction is allocated against the parent transaction.
      properties:
        transactionDesc:
          description: Description of the child transaction that took place.
          type: string
        chargeRefNo:
          description: Reference for the child transaction's relevant charge kind.
          type: string
        dueDate:
          description: Date the child transaction must be settled by.
          type: string
          format: date
        amount:
          description: Portion of the child transaction which is allocated against the parent.
          type: number
          minimum: -9.999999999999E10
          maximum: 9.999999999999E10
          multipleOf: 0.01
        clearingDate:
          description: Date the child transaction cleared against the parent.
          type: string
          format: date
        clearingReason:
          description: Reason the child transaction cleared against the parent.
          type: string
      required:
        - transactionDesc
        - amount
        - clearingDate

  examples:
    requests.TestOrganisationRequestExample:
      summary: Request example
      value:
        orgDetails:
          domesticOnly: true
          organisationName: Test Organisation Ltd
          registrationDate: "2024-01-01"
        accountingPeriod:
          startDate: "2024-01-01"
          endDate: "2024-12-31"
    responses.TestOrganisationResponseExample:
      summary: Response example
      value:
        pillar2Id: XAPLR1234567890
        organisation:
          orgDetails:
            domesticOnly: true
            organisationName: Test Organisation Ltd
            registrationDate: "2024-01-01"
          accountingPeriod:
            startDate: "2024-01-01"
            endDate: "2024-12-31"
          lastUpdated: "2024-01-01T12:00:00Z"
    requests.BTNRequestExample:
      summary: "Request example"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
    requests.ORNRequestExample:
      summary: "Request example"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        filedDateGIR: "2025-01-10"
        countryGIR: US
        reportingEntityName: Newco PLC
        TIN: US12345678
        issuingCountryTIN: US
    responses.BTNSuccessResponseExample:
      summary: "Success response"
      value:
        processingDate: "2026-06-26T09:26:17Z"
    responses.CreateTestGlobeInformationReturnResponseExample:
      summary: "Success response"
      value:
        processingDate: "2026-06-26T09:26:17Z"
    requests.CreateTestGlobeInformationReturnRequestExample:
      summary: "Request example"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
    #mne and uk
    requests.UKTRNilReturnMneAndUk:
      summary: "Nil Return - MNE and UK"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          returnType: NIL_RETURN
    #nil return - domestic only w/ uk gaap
    requests.UKTRNilReturnDomesticOnlyWithUkGaap:
      summary: "Nil Return - Domestic Only with UK GAAP"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          returnType: NIL_RETURN
    #nil return - domestic only w/o uk gaap
    requests.UKTRNilReturnDomesticOnlyWithoutUkGaap:
      summary: "Nil Return - Domestic Only without UK GAAP"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        obligationMTT: false
        electionUKGAAP: false
        liabilities:
          returnType: NIL_RETURN
    #liability return - mne and uk w/ 1 entity
    requests.UKTRLiabilityReturnMneAndUkWithOneEntity:
      summary: "Liability Return - MNE and UK with 1 Entity"
      value:
        accountingPeriodFrom: "2025-04-06"
        accountingPeriodTo: "2026-04-05"
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 14401.49
          totalLiabilityDTT: 5000.99
          totalLiabilityIIR: 3400
          totalLiabilityUTPR: 6000.5
          liableEntities:
            - ukChargeableEntityName: Newco PLC
              idType: CRN
              idValue: xyz
              amountOwedDTT: 5000.99
              amountOwedIIR: 3400
              amountOwedUTPR: 6000.5
    #liability return - mne and uk w/ 2 entities
    requests.UKTRLiabilityReturnMneAndUkWithTwoEntities:
      summary: "Liability Return - MNE and UK with 2 Entities"
      value:
        accountingPeriodFrom: "2025-04-06"
        accountingPeriodTo: "2026-04-05"
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 40968.88
          totalLiabilityDTT: 26567.89
          totalLiabilityIIR: 5000
          totalLiabilityUTPR: 9400.99
          liableEntities:
            - ukChargeableEntityName: Newco PLC
              idType: CRN
              idValue: xyz
              amountOwedDTT: 4567
              amountOwedIIR: 3000
              amountOwedUTPR: 4000.99
            - ukChargeableEntityName: Conew PLC
              idType: UTR
              idValue: xyz
              amountOwedDTT: 22000.89
              amountOwedIIR: 2000
              amountOwedUTPR: 5400
    #liability return - uk only - domestic flag, 1 entity and uk gaap
    requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap:
      summary: "Liability Return - Domestic Only with 1 Entity and UK GAAP"
      value:
        accountingPeriodFrom: "2025-01-01"
        accountingPeriodTo: "2026-12-31"
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 26567.89
          totalLiabilityDTT: 26567.89
          totalLiabilityIIR: 0
          totalLiabilityUTPR: 0
          liableEntities:
            - ukChargeableEntityName: Conew PLC
              idType: UTR
              idValue: xyz
              amountOwedDTT: 26567.89
              amountOwedIIR: 0
              amountOwedUTPR: 0
    #liability return - uk only - domestic flag, 2 entities
    requests.UKTRLiabilityReturnDomesticOnlyTwoEntities:
      summary: "Liability Return - Domestic Only with 2 Entities"
      value:
        accountingPeriodFrom: "2025-04-06"
        accountingPeriodTo: "2026-04-05"
        obligationMTT: false
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 10000
          totalLiabilityDTT: 10000
          totalLiabilityIIR: 0
          totalLiabilityUTPR: 0
          liableEntities:
            - ukChargeableEntityName: Newco PLC
              idType: CRN
              idValue: xyz
              amountOwedDTT: 5000
              amountOwedIIR: 0
              amountOwedUTPR: 0
            - ukChargeableEntityName: Conew PLC
              idType: CRN
              idValue: xyz
              amountOwedDTT: 5000
              amountOwedIIR: 0
              amountOwedUTPR: 0
    responses.UKTRSuccessResponseWithCrnExample:
      summary: Liability Success response
      value:
        processingDate: "2026-06-26T09:26:17Z"
        formBundleNumber: 119000004320
        chargeReference: 2347913284601
    responses.UKTRSuccessResponseWithoutCrnExample:
      summary: Nil Return Success response
      value:
        processingDate: "2026-06-26T09:26:17Z"
        formBundleNumber: 119000004320
    responses.UKTRNilReturnResponseExample:
      summary: "Request example for Domestic only with UK GAAP Nil Return"
      value:
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          returnType: "NIL_RETURN"
    responses.ORNSuccessResponseExample:
      summary: ORN Submit/Amend Success response
      value:
        processingDate: "2026-06-26T09:26:17Z"
        formBundleNumber: "119000004320"
    responses.ORNRetrieveSuccessResponseExample:
      summary: ORN Retrieve Success response
      value:
        processingDate: "2025-03-26T09:26:17Z"
        accountingPeriodFrom: "2024-01-01"
        accountingPeriodTo: "2024-12-31"
        filedDateGIR: "2025-01-10"
        countryGIR: "US"
        reportingEntityName: "Newco PLC"
        TIN: "US12345678"
        issuingCountryTIN: "US"
    errors.TestOrg.NotFound:
      summary: Test organisation not found
      value:
        code: "404"
        message: "Organisation not found for pillar2Id: XAPLR1234567890"
    errors.TestOrg.EndpointDisabled:
      summary: Test endpoints not available
      value:
        code: TEST_ENDPOINT_DISABLED
        message: Test endpoints are not available in this environment
    errors.MissingCredentials:
      summary: Missing Credentials
      value:
        code: "MISSING_CREDENTIALS"
        message: Authentication information is not provided
    errors.InvalidCredentials:
      summary: Invalid Credentials
      value:
        code: "INVALID_CREDENTIALS"
        message: Invalid Authentication information provided
    errors.InvalidDateRange:
      summary: Invalid date range
      value:
        code: "INVALID_DATE_RANGE"
        message: Invalid date range
    errors.InvalidDateFormat:
      summary: Invalid date format
      value:
        code: "INVALID_DATE_FORMAT"
        message: Invalid date format
    errors.InvalidJson:
      summary: Invalid JSON payload
      value:
        code: "INVALID_JSON"
        message: Invalid JSON payload
    errors.EmptyBody:
      summary: Empty request body
      value:
        code: "EMPTY_REQUEST_BODY"
        message: Empty request body
    errors.Submission.InvalidRequest:
      summary: Invalid request
      value:
        code: "003"
        message: Request could not be processed
    errors.Submission.NoSubscriptionData:
      summary: No subscription data
      value:
        code: "004"
        message: No Pillar2 subscription found for -pillar2Id
    errors.Submission.MissingPillar2Header:
      summary: Missing Pillar 2 header
      value:
        code: "MISSING_HEADER"
        message: Please provide the X-Pillar2-Id header
    errors.IncorrectHeaderValue:
      summary: Pillar 2 header does not match that in the bearer token
      value:
        code: "INCORRECT_HEADER_VALUE"
        message: X-Pillar2-Id Header value does not match the bearer token
    errors.Submission.GenericServerError:
      summary: Generic server error
      value:
        code: 500
        message: Internal Server Error
    errors.InvalidScope:
      summary: Invalid scope
      value:
        code: "INVALID_SCOPE"
        message: Can not access the required resource. Ensure this token has all the required scopes.
    errors.Submission.InvalidReturn:
      summary: Invalid return
      value:
        code: "093"
        message: Invalid Return
    errors.Submission.TaxObligationFulfilled:
      summary: Tax obligation fulfilled
      value:
        code: "044"
        message: Tax Obligation already fulfilled
    errors.Submission.NoActiveSubscription:
      summary: No active subscription
      value:
        code: "063"
        message: Business Partner does not have an Active Subscription for this Regime
    errors.Submission.DuplicateSubmission:
      summary: Duplicate submission
      value:
        code: "004"
        message: Duplicate submission
    errors.Submission.InvalidUTPR:
      summary: Invalid UTPR Election
      value:
        code: "095"
        message: Invalid UTPR Election
    errors.Submission.InvalidTotalLiabilityIIR:
      summary: Invalid Total Liability IIR
      value:
        code: "097"
        message: Invalid Total Liability IIR
    errors.Submission.InvalidDTT:
      summary: Invalid DTT Election
      value:
        code: "094"
        message: Invalid DTT Election
    errors.Submission.InvalidTotalLiabilityUTPR:
      summary: Invalid Total Liability UTPR
      value:
        code: "099"
        message: Invalid Total Liability UTPR
    errors.Submission.InvalidTotalLiability:
      summary: Invalid Total Liability
      value:
        code: "096"
        message: Invalid Total Liability
    errors.Submission.InvalidTotalLiabilityDTT:
      summary: Invalid Total Liability DTT
      value:
        code: "098"
        message: Invalid Total Liability DTT
    errors.Submission.AccountingPeriodUnderEnquiry:
      summary: Accounting Period Under Enquiry
      value:
        code: "100"
        message: Accounting period under enquiry
    errors.Submission.NoDataFound:
      summary: No data found
      value:
        code: "014"
        message: No data found
    errors.Retrieval.NotFound:
      summary: No data found
      value:
        code: "NOT_FOUND"
        message: The requested ORN could not be found
  securitySchemes:
    userRestricted:
      type: oauth2
      description: |
        HMRC supports OAuth 2.0 for authenticating user restricted API requests using an OAuth 2.0 Bearer Token in the AUTHORIZATION header.
        Please see the [developer hub](https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/user-restricted-endpoints) for more details.
      flows:
        authorizationCode:
          authorizationUrl: https://api.service.hmrc.gov.uk/oauth/authorize
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          refreshUrl: https://api.service.hmrc.gov.uk/oauth/refresh
          scopes:
            read:pillar2: Read data related to Pillar2 subscription
            write:pillar2: Write data related to Pillar2 subscription
