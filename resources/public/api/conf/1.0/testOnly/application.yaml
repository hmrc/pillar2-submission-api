openapi: 3.0.3
info:
  version: 0.150.0
  title: Pillar 2 API
  description: An API for managing and retrieving data in accordance with Pillar 2 tax rules.
tags: []
paths:
  /organisations/pillar-two/setup/organisation:
    post:
      operationId: createTestOrganisation
      tags:
      - setup
      summary: Create Test Organisation
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: "Pillar 2 Id - Pattern: [A-Z0-9]{1,15}"
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisation"
            examples:
              CreateTestOrganisationRequestExample:
                $ref: "#/components/examples/requests.TestOrganisationRequestExample"
      responses:
        "201":
          description: Test Organisation Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisationWithId"
              examples:
                CreateTestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "400":
          description: Invalid Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "409":
          description: Organisation Already Exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              example:
                code: 409
                message: "Organisation with pillar2Id: XAPLR1234567890 already exists"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              example:
                code: 500
                message: Failed to create organisation due to database error
      description: |
        Creates a test organisation associated with your authed organisation.
      security:
      - userRestricted:
        - write:pillar2
    get:
      operationId: getTestOrganisation
      tags:
      - setup
      summary: Get Test Organisation
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: "Pillar 2 Id - Pattern: [A-Z0-9]{1,15}"
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      responses:
        "200":
          description: Test Organisation Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisationWithId"
              examples:
                TestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              example:
                code: 500
                message: Internal Server Error
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
      description: |
        Gets a test organisation associated with your authed organisation.
      security:
      - userRestricted:
        - read:pillar2
    put:
      operationId: updateTestOrganisation
      tags:
      - setup
      summary: Update Test Organisation
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: "Pillar 2 Id - Pattern: [A-Z0-9]{1,15}"
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisation"
            examples:
              UpdateTestOrganisationRequestExample:
                $ref: "#/components/examples/requests.TestOrganisationRequestExample"
      responses:
        "200":
          description: Test Organisation Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisationWithId"
              examples:
                UpdateTestOrganisationResponseExample:
                  $ref: "#/components/examples/responses.TestOrganisationResponseExample"
        "400":
          description: Invalid Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              example:
                code: 500
                message: Failed to update organisation due to database error
      description: |
        Updates a test organisation associated with your authed organisation.
      security:
      - userRestricted:
        - write:pillar2
    delete:
      operationId: deleteTestOrganisation
      tags:
      - setup
      summary: Delete Test Organisation
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: "Pillar 2 Id - Pattern: [A-Z0-9]{1,15}"
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      responses:
        "204":
          description: Test Organisation and Submission Data Deleted Successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Test Endpoint Disabled:
                  $ref: "#/components/examples/errors.TestOrg.EndpointDisabled"
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Not Found:
                  $ref: "#/components/examples/errors.TestOrg.NotFound"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              example:
                code: 500
                message: Failed to delete organisation and submission data
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
      description: |
        Deletes a test organisation associated with your authed organisation.
      security:
      - userRestricted:
        - write:pillar2
  /organisations/pillar-two/setup/globe-information-return:
    post:
      operationId: createGIR
      tags:
      - setup
      summary: Create A Test GloBE Information Return
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: "Pillar 2 Id - Pattern: [A-Z0-9]{1,15}"
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.globeinformationreturn.GIRSubmission"
            examples:
              CreateTestGlobeInformationReturnRequestExample:
                $ref: "#/components/examples/requests.CreateTestGlobeInformationReturnRequestExample"
      responses:
        "201":
          description: Globe Information Return Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.globeinformationreturn.GIRSuccess"
              examples:
                CreateTestGlobeInformationReturnResponseExample:
                  $ref: "#/components/examples/responses.CreateTestGlobeInformationReturnResponseExample"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid JSON:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      description: |
        Creates a GloBE Information Return for a test organisation.
      security:
      - userRestricted:
        - write:pillar2
  /organisations/pillar-two/uk-tax-return:
    post:
      operationId: submitUKTR
      tags:
      - submission
      summary: Submit UK Tax Return
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        required: true
        name: X-Pillar2-Id
        schema:
          type: string
        description: Pillar2 ID for the submission
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              oneOf:
              - $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionData"
              - $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionNilReturn"
            examples:
              NilReturnMneAndUk:
                $ref: "#/components/examples/requests.UKTRNilReturnMneAndUk"
              NilReturnDomesticOnlyWithUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithUkGaap"
              NilReturnDomesticOnlyWithoutUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithoutUkGaap"
              LiabilityReturnMneAndUkOneEntity:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithOneEntity"
              LiabilityReturnMneAndUkTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithTwoEntities"
              LiabilityReturnDomesticOneEntityUkGaap:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap"
              LiabilityReturnDomesticTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyTwoEntities"
      responses:
        "201":
          description: UK Tax Return Submission Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.responses.UKTRSubmitSuccessResponse"
              examples:
                responses.UKTRSuccessResponseWithCRNExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithCrnExample"
                responses.UKTRSuccessResponseWithoutCrnExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithoutCrnExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid UTPR Election:
                  $ref: "#/components/examples/errors.Submission.InvalidUTPR"
                Invalid Total Liability IIR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityIIR"
                Invalid DTT Election:
                  $ref: "#/components/examples/errors.Submission.InvalidDTT"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Invalid Total Liability UTPR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityUTPR"
                Invalid Total Liability:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiability"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Total Liability DTT:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityDTT"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      description: |
        Submits a UK Tax Return for a specified accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a SubmitUKTR or AmendUKTR request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account. If you are amending an existing return, please check the request dates fall within the amendment window (12 months after the due date, minus 1 day).</td>
        </tr>
        <tr>
        <td>044 - Tax Obligation already fulfilled</td>
        <td>A UKTR for the specified period has already been submitted. If you are trying to amend a UKTR, please check you are sending the <em>amendUKTR</em> API request.</td>
        </tr>
        <tr>
        <td>063 - Business partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        <tr>
        <td>093 - Invalid Return</td>
        <td>There is an error with the tax return you’ve submitted in the request. Entities registered as UK only should check that <em>obligationMTT</em> is set to false, and <em>totalLiabilityIIR</em> and <em>totalLiabilityUTPR</em> should be set to 0. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in the test organisation. If you need to check or amend the accounting period pattern, you can do this on the Pillar 2 site under “Personal Details”.</td>
        </tr>
        <tr>
        <td>094 - Invalid DTT Election</td>
        <td>The DTT values in the request are invalid. Please complete the following checks, then submit the request again. If <em>electionDTTSingleMember</em> is true, the <em>numberSubGroupDTT</em> should be greater than 0. This number represents the number of liable entities that owe a DTT amount greater than 0. The total number of liable entities who owe DTT in the payload should be the same as the number in <em>numberSubGroupDTT</em>.</td>
        </tr>
        <tr>
        <td>095 - Invalid UTPR Election</td>
        <td>The UTPR values in the request are invalid. Please complete the following checks, then submit the request again. If <em>electionUTPRSingleMember</em> is true, the <em>numberSubGroupUTPR</em> should be greater than 0. This number represents the number of liable entities that owe a UTPR amount greater than 0. The total number of liable entities who owe UTPR in the payload should be the same as the number in <em>numberSubGroupUTPR</em>.</td>
        </tr>
        <tr>
        <td>096 - Invalid Total Liability</td>
        <td>The <em>totalLiability</em> value in the request does not match the combined values of <em>totalLiabilityDTT</em>, <em>totalLiabilityIIR</em> and <em>totalLiabilityUTPR</em>. Please check the sum of these fields matches the <em>totalLiability</em> value and submit the request again.</td>
        </tr>
        <tr>
        <td>097 - Invalid Total Liability IIR</td>
        <td>The <em>totalLiabilityIIR</em> value does not match the <em>amountIIR value</em> from the <em>liableEntities</em> array. IIR values should only be entered by entities registered as a Multinational Enterprise. Please check the individual totals of each entity and submit the request again.</td>
        </tr>
        <tr>
        <td>098 - Invalid Total Liability DTT</td>
        <td>The <em>totalLiabilityDTT</em> value does not match the <em>amountDTT</em> value from the <em>liableEntities</em> array. Please check the value of these fields matches and submit the request again.</td>
        </tr>
        <tr>
        <td>099 - Invalid Total Liability UTPR</td>
        <td>The <em>totalLiabilityUTPR</em> value does not match the <em>amountUTPR</em> value from the <em>liableEntities</em> array. UTPR values should only be entered by entities registered as a Multinational Enterprise. Please check the individual totals of each entity and submit the request again.</td>
        </tr>
        </tbody>
        </table>
      security:
      - userRestricted:
        - write:pillar2
    put:
      operationId: amendUKTR
      tags:
      - submission
      summary: Amend UK Tax Return
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: Pillar2 ID for the submission
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              oneOf:
              - $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionData"
              - $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionNilReturn"
            examples:
              NilReturnMneAndUk:
                $ref: "#/components/examples/requests.UKTRNilReturnMneAndUk"
              NilReturnDomesticOnlyWithUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithUkGaap"
              NilReturnDomesticOnlyWithoutUkGaap:
                $ref: "#/components/examples/requests.UKTRNilReturnDomesticOnlyWithoutUkGaap"
              LiabilityReturnMneAndUkOneEntity:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithOneEntity"
              LiabilityReturnMneAndUkTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnMneAndUkWithTwoEntities"
              LiabilityReturnDomesticOneEntityUkGaap:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap"
              LiabilityReturnDomesticTwoEntities:
                $ref: "#/components/examples/requests.UKTRLiabilityReturnDomesticOnlyTwoEntities"
      responses:
        "200":
          description: UK Tax Return Submission Updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.responses.UKTRSubmitSuccessResponse"
              examples:
                responses.UKTRSuccessResponseWithCRNExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithCrnExample"
                responses.UKTRSuccessResponseWithoutCrnExample:
                  $ref: "#/components/examples/responses.UKTRSuccessResponseWithoutCrnExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid UTPR Election:
                  $ref: "#/components/examples/errors.Submission.InvalidUTPR"
                Invalid Total Liability IIR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityIIR"
                Invalid DTT Election:
                  $ref: "#/components/examples/errors.Submission.InvalidDTT"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Invalid Total Liability UTPR:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityUTPR"
                Invalid Total Liability:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiability"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Total Liability DTT:
                  $ref: "#/components/examples/errors.Submission.InvalidTotalLiabilityDTT"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      description: "Amends a UK tax return submitted for a specified accounting period.   \n\n### Error Codes\n<p>AmendUKTR generates the same error codes as Submit UKTR, please use the Error Codes table in the SubmitUKTR section above.</p>\n"
      security:
      - userRestricted:
        - write:pillar2
  /organisations/pillar-two/below-threshold-notification:
    post:
      operationId: submitBTN
      tags:
      - submission
      summary: Submit Below-Threshold Notification
      parameters:
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: Pillar2 ID for the submission
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.belowthresholdnotification.BTNSubmission"
            examples:
              requests.BTNRequestExample:
                $ref: "#/components/examples/requests.BTNRequestExample"
      responses:
        "201":
          description: Below-Threshold Notification Submission Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.belowthresholdnotification.SubmitBTNSuccessResponse"
              examples:
                responses.BTNSuccessResponseExample:
                  $ref: "#/components/examples/responses.BTNSuccessResponseExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                No Active Subscription:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Accounting Period Under Enquiry:
                  $ref: "#/components/examples/errors.Submission.AccountingPeriodUnderEnquiry"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
        "400":
          description: Bad Request
          content:
            application/json:
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
      description: |
        Submits a Below-Threshold Notification for a specified accounting period when the group no longer meets the threshold for the Pillar 2 top-up tax.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a SubmitBTN request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account.</td>
        </tr>
        <tr>
        <td>044 - Tax Obligation already fulfilled</td>
        <td>A BTN for the specified period has already been submitted.</td>
        </tr>
        <tr>
        <td>063 - Business partner does not have an Active Subscription for this Regime</td>
        <td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>
        </tr>
        </tbody>
        </table>
      security:
      - userRestricted:
        - write:pillar2
  /organisations/pillar-two/obligations-and-submissions:
    get:
      operationId: retrieveData
      tags:
      - submission
      parameters:
      - in: query
        name: fromDate
        required: true
        schema:
          type: string
      - in: query
        name: toDate
        required: true
        schema:
          type: string
      summary: Retrieve Obligations and Submissions
      description: |
        Retrieves the Obligations and Submissions for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a Retrieve Obligations and Submissions request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account.</td>
        </tr>
        <tr>
        <td>014 - No data found</td>
        <td>No data found for this Pillar 2 ID.</td>
        </tr>
        <tr>
        </tbody>
        </table>
      responses:
        "500":
          description: Internal Server Error
          content:
            application/json:
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
        "403":
          description: Forbidden
          content:
            application/json:
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Data Found:
                  $ref: "#/components/examples/errors.Submission.NoDataFound"
        "401":
          description: Unauthorized
          content:
            application/json:
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "400":
          description: Invalid Request
          content:
            application/json:
              examples:
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
                Invalid Date Format:
                  $ref: "#/components/examples/errors.InvalidDateFormat"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "200":
          description: OK Obligations and Submissions retrieved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ObligationsAndSubmissionsSuccessResponse"
      security:
      - userRestricted:
        - read:pillar2
  /organisations/pillar-two/overseas-return-notification:
    post:
      operationId: submitORN
      tags:
      - submission
      summary: Submit Overseas Return Notification
      parameters:
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: Pillar2 ID for the submission.
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSubmission"
            examples:
              requests.ORNRequestExample:
                $ref: "#/components/examples/requests.ORNRequestExample"
      responses:
        "201":
          description: Overseas Return Notification Submission Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSuccessResponse"
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNSuccessResponseExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Tax Obligation Fulfilled:
                  $ref: "#/components/examples/errors.Submission.TaxObligationFulfilled"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      description: "Submits an Overseas Return Notification for an accounting period.\n### Error Codes\n<p>This table contains a list of 422 error codes returned when a Submit Overseas Return Notification request is not processed successfully.</p> \n<table>\n<thead>\n<tr>\n<th>Error Message</th>\n<th>Next Steps</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>003 - Request could not be processed</td>\n<td>The message could not be processed due to locking. Please make the following checks. Confirm if there is currently an open enquiry on your tax account. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in your test organisation. The <em>filedDateGIR</em> date should not be in the future. The <em>countryGIR</em> and <em>issuingCountryTIN</em> fields must conform to the ISO-3166 standard for country codes. In the organisation’s settings, the <em>accountStatus</em> should have the <em>inactive</em> flag set to “false\".\n</td>\n</tr>\n<tr>\n<td>044 - Tax Obligation already fulfilled</td>\n<td>A BTN for the specified period has already been submitted.</td>\n</tr>\n<tr>\n<td>063 - Business Partner does not have an Active Subscription for this Regime</td>\n<td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>\n</tr>\n<tr>\n<td>093 - Invalid Return</td>\n<td>There is an error with the return you’ve submitted in the request.</td>\n</tr>\n</tbody>\n</table>\n"
      security:
      - userRestricted:
        - write:pillar2
    put:
      operationId: amendORN
      tags:
      - submission
      summary: Amend Overseas Return Notification
      parameters:
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: Pillar2 ID for the submission.
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSubmission"
            examples:
              requests.ORNRequestExample:
                $ref: "#/components/examples/requests.ORNRequestExample"
      responses:
        "200":
          description: Overseas Return Notification Submission Amended
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSuccessResponse"
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNSuccessResponseExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
                No Active Subscription Found:
                  $ref: "#/components/examples/errors.Submission.NoActiveSubscription"
                Invalid Return:
                  $ref: "#/components/examples/errors.Submission.InvalidReturn"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Json:
                  $ref: "#/components/examples/errors.InvalidJson"
                Empty Request Body:
                  $ref: "#/components/examples/errors.EmptyBody"
                Missing Header:
                  $ref: "#/components/examples/errors.Submission.MissingPillar2Header"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
                No Subscription Data:
                  $ref: "#/components/examples/errors.Submission.NoSubscriptionData"
      description: "Amends an Overseas Return Notification for an accounting period.\n### Error Codes\n<p>This table contains a list of 422 error codes returned when an Amend Overseas Return Notification request is not processed successfully.</p> \n<table>\n<thead>\n<tr>\n<th>Error Message</th>\n<th>Next Steps</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>003 - Request could not be processed</td>\n<td>The message could not be processed due to locking. Please make the following checks. Confirm if there is currently an open enquiry on your tax account. The <em>accountingPeriodFrom</em> and <em>accountingPeriodTo</em> date range should match the period defined in your test organisation. The <em>filedDateGIR</em> date should not be in the future. The <em>countryGIR</em> and <em>issuingCountryTIN</em> fields must conform to the ISO-3166 standard for country codes. In the organisation’s settings, the <em>accountStatus</em> should have the <em>inactive</em> flag set to “false\".\n</td>\n</tr>\n<tr>\n<td>063 - Business Partner does not have an Active Subscription for this Regime</td>\n<td>The Pillar 2 ID in the request header is not listed as active by HMRC for this regime. Please contact the central support team.</td>\n</tr>\n<tr>\n<td>093 - Invalid Return</td>\n<td>There is an error with the return you’ve submitted in the request.</td>\n</tr>\n</tbody>\n</table>\n"
      security:
      - userRestricted:
        - write:pillar2
    get:
      operationId: retrieveORN
      tags:
      - submission
      summary: Retrieve Overseas Return Notification
      parameters:
      - in: query
        name: accountingPeriodFrom
        required: true
        schema:
          type: string
          format: date
        description: Period start date
      - in: query
        name: accountingPeriodTo
        required: true
        schema:
          type: string
          format: date
        description: Period end date
      - in: header
        name: Authorization
        required: true
        schema:
          type: string
        description: Bearer token for authentication
      - in: header
        name: X-Pillar2-Id
        required: true
        schema:
          type: string
        description: Pillar2 ID for the submission
      - in: header
        name: Accept
        required: false
        schema:
          type: string
          example: application/vnd.hmrc.1.0+json
        description: "Specifies the expected response format as versioned JSON from the HMRC API (v1.0). If not provided, it will default to application/vnd.hmrc.1.0+json."
      responses:
        "200":
          description: Overseas Return Notification Retrieved Successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNRetrieveSuccessResponse"
              examples:
                responses.ORNSuccessResponseExample:
                  $ref: "#/components/examples/responses.ORNRetrieveSuccessResponseExample"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Missing Credentials:
                  $ref: "#/components/examples/errors.MissingCredentials"
                Invalid Credentials:
                  $ref: "#/components/examples/errors.InvalidCredentials"
        "422":
          description: Business Validation Failure
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Request:
                  $ref: "#/components/examples/errors.Submission.InvalidRequest"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Date Range:
                  $ref: "#/components/examples/errors.InvalidDateRange"
                Invalid Date Format:
                  $ref: "#/components/examples/errors.InvalidDateFormat"
                Incorrect Header Value:
                  $ref: "#/components/examples/errors.IncorrectHeaderValue"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Invalid Scope:
                  $ref: "#/components/examples/errors.InvalidScope"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                NotFound:
                  $ref: "#/components/examples/errors.Retrieval.NotFound"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse"
              examples:
                Generic Server Error:
                  $ref: "#/components/examples/errors.Submission.GenericServerError"
      description: |
        Retrieves an Overseas Return Notification for an accounting period.
        ### Error Codes
        <p>This table contains a list of 422 error codes returned when a Retrieve Overseas Return Notification request is not processed successfully.</p>
        <table>
        <thead>
        <tr>
        <th>Error Message</th>
        <th>Next Steps</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td>003 - Request could not be processed</td>
        <td>The message could not be processed due to locking. Please check if there is currently an open enquiry on your tax account./td>
        </tr>
        </tbody>
        </table>
      security:
      - userRestricted:
        - read:pillar2
components:
  schemas:
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNRetrieveSuccessResponse:
      properties:
        processingDate:
          type: string
        accountingPeriodFrom:
          type: string
        accountingPeriodTo:
          type: string
        filedDateGIR:
          type: string
        countryGIR:
          type: string
        reportingEntityName:
          type: string
        TIN:
          type: string
        issuingCountryTIN:
          type: string
      required:
      - processingDate
      - accountingPeriodFrom
      - accountingPeriodTo
      - filedDateGIR
      - countryGIR
      - reportingEntityName
      - TIN
      - issuingCountryTIN
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSuccessResponse:
      properties:
        processingDate:
          type: string
        formBundleNumber:
          type: string
      required:
      - processingDate
      - formBundleNumber
    uk.gov.hmrc.pillar2submissionapi.models.overseasreturnnotification.ORNSubmission:
      properties:
        accountingPeriodFrom:
          type: string
          format: date
        accountingPeriodTo:
          type: string
          format: date
        filedDateGIR:
          type: string
          format: date
        countryGIR:
          type: string
          minLength: 1
          maxLength: 2
        reportingEntityName:
          type: string
          minLength: 1
          maxLength: 200
        TIN:
          type: string
          minLength: 1
          maxLength: 200
        issuingCountryTIN:
          type: string
          minLength: 1
          maxLength: 2
      required:
      - accountingPeriodFrom
      - accountingPeriodTo
      - filedDateGIR
      - countryGIR
      - reportingEntityName
      - TIN
      - issuingCountryTIN
    uk.gov.hmrc.pillar2submissionapi.models.belowthresholdnotification.SubmitBTNSuccessResponse:
      properties:
        processingDate:
          type: string
      required:
      - processingDate
    uk.gov.hmrc.pillar2submissionapi.models.belowthresholdnotification.BTNSubmission:
      properties:
        accountingPeriodFrom:
          type: string
          format: date
        accountingPeriodTo:
          type: string
          format: date
      required:
      - accountingPeriodFrom
      - accountingPeriodTo
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.responses.UKTRSubmitSuccessResponse:
      properties:
        processingDate:
          type: string
          format: date-time
        formBundleNumber:
          type: string
        chargeReference:
          type: string
          nullable: true
      required:
      - processingDate
      - formBundleNumber
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityNilReturn:
      properties:
        returnType:
          type: string
          enum:
          - NIL_RETURN
      required:
      - returnType
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionNilReturn:
      properties:
        accountingPeriodFrom:
          type: string
          format: date
        accountingPeriodTo:
          type: string
          format: date
        obligationMTT:
          type: boolean
        electionUKGAAP:
          type: boolean
        liabilities:
          $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityNilReturn"
      required:
      - accountingPeriodFrom
      - accountingPeriodTo
      - obligationMTT
      - electionUKGAAP
      - liabilities
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiableEntity:
      properties:
        ukChargeableEntityName:
          type: string
        idType:
          type: string
        idValue:
          type: string
        amountOwedDTT:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        amountOwedIIR:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        amountOwedUTPR:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
      required:
      - ukChargeableEntityName
      - idType
      - idValue
      - amountOwedDTT
      - amountOwedIIR
      - amountOwedUTPR
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityData:
      properties:
        electionDTTSingleMember:
          type: boolean
        electionUTPRSingleMember:
          type: boolean
        numberSubGroupDTT:
          type: integer
          format: int32
        numberSubGroupUTPR:
          type: integer
          format: int32
        totalLiability:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        totalLiabilityDTT:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        totalLiabilityIIR:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        totalLiabilityUTPR:
          type: number
          format: double
          minimum: 0
          maximum: 9.99999999999999E12
        liableEntities:
          type: array
          items:
            $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiableEntity"
      required:
      - electionDTTSingleMember
      - electionUTPRSingleMember
      - numberSubGroupDTT
      - numberSubGroupUTPR
      - totalLiability
      - totalLiabilityDTT
      - totalLiabilityIIR
      - totalLiabilityUTPR
      - liableEntities
    uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.UKTRSubmissionData:
      properties:
        accountingPeriodFrom:
          type: string
          format: date
        accountingPeriodTo:
          type: string
          format: date
        obligationMTT:
          type: boolean
        electionUKGAAP:
          type: boolean
        liabilities:
          $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.uktrsubmissions.LiabilityData"
      required:
      - accountingPeriodFrom
      - accountingPeriodTo
      - obligationMTT
      - electionUKGAAP
      - liabilities
    uk.gov.hmrc.pillar2submissionapi.models.globeinformationreturn.GIRSuccess:
      properties:
        processingDate:
          type: string
      required:
      - processingDate
    uk.gov.hmrc.pillar2submissionapi.models.globeinformationreturn.GIRSubmission:
      properties:
        accountingPeriodFrom:
          type: string
          format: date
        accountingPeriodTo:
          type: string
          format: date
      required:
      - accountingPeriodFrom
      - accountingPeriodTo
    uk.gov.hmrc.pillar2submissionapi.models.response.Pillar2ErrorResponse:
      properties:
        code:
          type: string
        message:
          type: string
      required:
      - code
      - message
    uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisationWithId:
      properties:
        pillar2Id:
          type: string
        organisation:
          $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisation"
      required:
      - pillar2Id
      - organisation
    uk.gov.hmrc.pillar2submissionapi.models.organisation.AccountingPeriod:
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        underEnquiry:
          type: boolean
          nullable: true
      required:
      - startDate
      - endDate
    uk.gov.hmrc.pillar2submissionapi.models.organisation.OrgDetails:
      properties:
        domesticOnly:
          type: boolean
        organisationName:
          type: string
        registrationDate:
          type: string
          format: date
      required:
      - domesticOnly
      - organisationName
      - registrationDate
    uk.gov.hmrc.pillar2submissionapi.models.organisation.TestOrganisation:
      properties:
        orgDetails:
          $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.OrgDetails"
        accountingPeriod:
          $ref: "#/components/schemas/uk.gov.hmrc.pillar2submissionapi.models.organisation.AccountingPeriod"
        lastUpdated:
          type: string
          format: date-time
      required:
      - orgDetails
      - accountingPeriod
      - lastUpdated
    Submission:
      properties:
        submissionType:
          type: string
          enum:
          - UKTR_CREATE
          - UKTR_AMEND
          - ORN_CREATE
          - ORN_AMEND
          - BTN
          - GIR
        receivedDate:
          type: string
          format: date-time
        country:
          type: string
          nullable: true
      required:
      - submissionType
      - receivedDate
    AccountingPeriodDetails:
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        dueDate:
          type: string
          format: date
        underEnquiry:
          type: boolean
        obligations:
          type: array
          items:
            $ref: "#/components/schemas/Obligation"
      required:
      - startDate
      - endDate
      - dueDate
      - underEnquiry
      - obligations
    Obligation:
      properties:
        obligationType:
          type: string
          enum:
          - UKTR
          - GIR
        status:
          type: string
          enum:
          - Open
          - Fulfilled
        canAmend:
          type: boolean
        submissions:
          type: array
          items:
            $ref: "#/components/schemas/Submission"
      required:
      - obligationType
      - status
      - canAmend
      - submissions
    ObligationsAndSubmissionsSuccessResponse:
      properties:
        processingDate:
          type: string
          format: date-time
        accountingPeriodDetails:
          type: array
          items:
            $ref: "#/components/schemas/AccountingPeriodDetails"
      required:
      - processingDate
      - accountingPeriodDetails
  examples:
    requests.TestOrganisationRequestExample:
      summary: Request example
      value:
        orgDetails:
          domesticOnly: true
          organisationName: Test Organisation Ltd
          registrationDate: 2024-01-01
        accountingPeriod:
          startDate: 2024-01-01
          endDate: 2024-12-31
        lastUpdated: 2024-01-01T12:00:00Z
    responses.TestOrganisationResponseExample:
      summary: Response example
      value:
        pillar2Id: XAPLR1234567890
        organisation:
          orgDetails:
            domesticOnly: true
            organisationName: Test Organisation Ltd
            registrationDate: 2024-01-01
          accountingPeriod:
            startDate: 2024-01-01
            endDate: 2024-12-31
          lastUpdated: 2024-01-01T12:00:00Z
    requests.BTNRequestExample:
      summary: Request example
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
    requests.ORNRequestExample:
      summary: Request example
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        filedDateGIR: 2025-01-10
        countryGIR: US
        reportingEntityName: Newco PLC
        TIN: US12345678
        issuingCountryTIN: US
    responses.BTNSuccessResponseExample:
      summary: Success response
      value:
        processingDate: 2026-06-26T09:26:17Z
    responses.CreateTestGlobeInformationReturnResponseExample:
      summary: Success response
      value:
        processingDate: 2026-06-26T09:26:17Z
    requests.CreateTestGlobeInformationReturnRequestExample:
      summary: Request example
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
    requests.UKTRNilReturnMneAndUk:
      summary: Nil Return - MNE and UK
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          returnType: NIL_RETURN
    requests.UKTRNilReturnDomesticOnlyWithUkGaap:
      summary: Nil Return - Domestic Only with UK GAAP
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          returnType: NIL_RETURN
    requests.UKTRNilReturnDomesticOnlyWithoutUkGaap:
      summary: Nil Return - Domestic Only without UK GAAP
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        obligationMTT: false
        electionUKGAAP: false
        liabilities:
          returnType: NIL_RETURN
    requests.UKTRLiabilityReturnMneAndUkWithOneEntity:
      summary: Liability Return - MNE and UK with 1 Entity
      value:
        accountingPeriodFrom: 2025-04-06
        accountingPeriodTo: 2026-04-05
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 14401.49
          totalLiabilityDTT: 5000.99
          totalLiabilityIIR: 3400
          totalLiabilityUTPR: 6000.5
          liableEntities:
          - ukChargeableEntityName: Newco PLC
            idType: CRN
            idValue: xyz
            amountOwedDTT: 5000.99
            amountOwedIIR: 3400
            amountOwedUTPR: 6000.5
    requests.UKTRLiabilityReturnMneAndUkWithTwoEntities:
      summary: Liability Return - MNE and UK with 2 Entities
      value:
        accountingPeriodFrom: 2025-04-06
        accountingPeriodTo: 2026-04-05
        obligationMTT: true
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 40968.88
          totalLiabilityDTT: 26567.89
          totalLiabilityIIR: 5000
          totalLiabilityUTPR: 9400.99
          liableEntities:
          - ukChargeableEntityName: Newco PLC
            idType: CRN
            idValue: xyz
            amountOwedDTT: 4567
            amountOwedIIR: 3000
            amountOwedUTPR: 4000.99
          - ukChargeableEntityName: Conew PLC
            idType: CT-UTR
            idValue: xyz
            amountOwedDTT: 22000.89
            amountOwedIIR: 2000
            amountOwedUTPR: 5400
    requests.UKTRLiabilityReturnDomesticOnlyOneEntityAndUkGaap:
      summary: Liability Return - Domestic Only with 1 Entity and UK GAAP
      value:
        accountingPeriodFrom: 2025-01-01
        accountingPeriodTo: 2026-12-31
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 34968.98
          totalLiabilityDTT: 26567.89
          totalLiabilityIIR: 3400
          totalLiabilityUTPR: 5000.99
          liableEntities:
          - ukChargeableEntityName: Conew PLC
            idType: CT-UTR
            idValue: xyz
            amountOwedDTT: 26567.89
            amountOwedIIR: 3400
            amountOwedUTPR: 5000.99
    requests.UKTRLiabilityReturnDomesticOnlyTwoEntities:
      summary: Liability Return - Domestic Only with 2 Entities
      value:
        accountingPeriodFrom: 2025-04-06
        accountingPeriodTo: 2026-04-05
        obligationMTT: false
        electionUKGAAP: false
        liabilities:
          electionDTTSingleMember: false
          electionUTPRSingleMember: false
          numberSubGroupDTT: 4
          numberSubGroupUTPR: 5
          totalLiability: 10000
          totalLiabilityDTT: 10000
          totalLiabilityIIR: 0
          totalLiabilityUTPR: 0
          liableEntities:
          - ukChargeableEntityName: Newco PLC
            idType: CRN
            idValue: xyz
            amountOwedDTT: 5000
            amountOwedIIR: 0
            amountOwedUTPR: 0
          - ukChargeableEntityName: Conew PLC
            idType: CRN
            idValue: xyz
            amountOwedDTT: 5000
            amountOwedIIR: 0
            amountOwedUTPR: 0
    responses.UKTRSuccessResponseWithCrnExample:
      summary: Liability Success response
      value:
        processingDate: 2026-06-26T09:26:17Z
        formBundleNumber: 119000004320
        chargeReference: 2347913284601
    responses.UKTRSuccessResponseWithoutCrnExample:
      summary: Nil Return Success response
      value:
        processingDate: 2026-06-26T09:26:17Z
        formBundleNumber: 119000004320
    responses.UKTRNilReturnResponseExample:
      summary: Request example for Domestic only with UK GAAP Nil Return
      value:
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        obligationMTT: false
        electionUKGAAP: true
        liabilities:
          returnType: NIL_RETURN
    responses.ORNSuccessResponseExample:
      summary: ORN Submit/Amend Success response
      value:
        processingDate: 2026-06-26T09:26:17Z
        formBundleNumber: 119000004320
    responses.ORNRetrieveSuccessResponseExample:
      summary: ORN Retrieve Success response
      value:
        processingDate: 2025-03-26T09:26:17Z
        accountingPeriodFrom: 2024-01-01
        accountingPeriodTo: 2024-12-31
        filedDateGIR: 2025-01-10
        countryGIR: US
        reportingEntityName: Newco PLC
        TIN: US12345678
        issuingCountryTIN: US
    errors.TestOrg.NotFound:
      summary: Test organisation not found
      value:
        code: 404
        message: "Organisation not found for pillar2Id: XAPLR1234567890"
    errors.TestOrg.EndpointDisabled:
      summary: Test endpoints not available
      value:
        code: TEST_ENDPOINT_DISABLED
        message: Test endpoints are not available in this environment
    errors.MissingCredentials:
      summary: Missing Credentials
      value:
        code: MISSING_CREDENTIALS
        message: Authentication information is not provided
    errors.InvalidCredentials:
      summary: Invalid Credentials
      value:
        code: INVALID_CREDENTIALS
        message: Invalid Authentication information provided
    errors.InvalidDateRange:
      summary: Invalid date range
      value:
        code: INVALID_DATE_RANGE
        message: Invalid date range
    errors.InvalidDateFormat:
      summary: Invalid date format
      value:
        code: INVALID_DATE_FORMAT
        message: Invalid date format
    errors.InvalidJson:
      summary: Invalid JSON payload
      value:
        code: INVALID_JSON
        message: Invalid JSON payload
    errors.EmptyBody:
      summary: Empty request body
      value:
        code: EMPTY_REQUEST_BODY
        message: Empty request body
    errors.Submission.InvalidRequest:
      summary: Invalid request
      value:
        code: '003'
        message: Request could not be processed
    errors.Submission.NoSubscriptionData:
      summary: No subscription data
      value:
        code: '004'
        message: No Pillar2 subscription found for -pillar2Id
    errors.Submission.MissingPillar2Header:
      summary: Missing Pillar 2 header
      value:
        code: MISSING_HEADER
        message: Please provide the X-Pillar2-Id header
    errors.IncorrectHeaderValue:
      summary: Pillar 2 header does not match that in the bearer token
      value:
        code: INCORRECT_HEADER_VALUE
        message: X-Pillar2-Id Header value does not match the bearer token
    errors.Submission.GenericServerError:
      summary: Generic server error
      value:
        code: 500
        message: Internal Server Error
    errors.InvalidScope:
      summary: Invalid scope
      value:
        code: INVALID_SCOPE
        message: Can not access the required resource. Ensure this token has all the required scopes.
    errors.Submission.InvalidReturn:
      summary: Invalid return
      value:
        code: '093'
        message: Invalid Return
    errors.Submission.TaxObligationFulfilled:
      summary: Tax obligation fulfilled
      value:
        code: '044'
        message: Tax Obligation already fulfilled
    errors.Submission.NoActiveSubscription:
      summary: No active subscription
      value:
        code: '063'
        message: Business Partner does not have an Active Subscription for this Regime
    errors.Submission.DuplicateSubmission:
      summary: Duplicate submission
      value:
        code: '004'
        message: Duplicate submission
    errors.Submission.InvalidUTPR:
      summary: Invalid UTPR Election
      value:
        code: '095'
        message: Invalid UTPR Election
    errors.Submission.InvalidTotalLiabilityIIR:
      summary: Invalid Total Liability IIR
      value:
        code: '097'
        message: Invalid Total Liability IIR
    errors.Submission.InvalidDTT:
      summary: Invalid DTT Election
      value:
        code: '094'
        message: Invalid DTT Election
    errors.Submission.InvalidTotalLiabilityUTPR:
      summary: Invalid Total Liability UTPR
      value:
        code: '099'
        message: Invalid Total Liability UTPR
    errors.Submission.InvalidTotalLiability:
      summary: Invalid Total Liability
      value:
        code: '096'
        message: Invalid Total Liability
    errors.Submission.InvalidTotalLiabilityDTT:
      summary: Invalid Total Liability DTT
      value:
        code: '098'
        message: Invalid Total Liability DTT
    errors.Submission.AccountingPeriodUnderEnquiry:
      summary: Accounting Period Under Enquiry
      value:
        code: 100
        message: Accounting period under enquiry
    errors.Submission.NoDataFound:
      summary: No data found
      value:
        code: '014'
        message: No data found
    errors.Retrieval.NotFound:
      summary: No data found
      value:
        code: NOT_FOUND
        message: The requested ORN could not be found
  securitySchemes:
    userRestricted:
      type: oauth2
      description: |
        HMRC supports OAuth 2.0 for authenticating user restricted API requests using an OAuth 2.0 Bearer Token in the AUTHORIZATION header.
        Please see the [developer hub](https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/user-restricted-endpoints) for more details.
      flows:
        authorizationCode:
          authorizationUrl: https://api.service.hmrc.gov.uk/oauth/authorize
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          refreshUrl: https://api.service.hmrc.gov.uk/oauth/refresh
          scopes:
            read:pillar2: Read data related to Pillar2 subscription
            write:pillar2: Write data related to Pillar2 subscription
servers:
- url: https://test-api.service.hmrc.gov.uk
  description: Sandbox
- url: https://api.service.hmrc.gov.uk
  description: Production
